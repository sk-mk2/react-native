b10672db0c9cb7464747dd5901591bf0
'use strict';var MatrixMath=require('MatrixMath');var Platform=require('Platform');var invariant=require('fbjs/lib/invariant');var stringifySafe=require('stringifySafe');function processTransform(transform){if(__DEV__){_validateTransforms(transform);}if(Platform.OS==='android'||Platform.OS==='ios'){return transform;}var result=MatrixMath.createIdentityMatrix();transform.forEach(function(transformation){var key=Object.keys(transformation)[0];var value=transformation[key];switch(key){case'matrix':MatrixMath.multiplyInto(result,result,value);break;case'perspective':_multiplyTransform(result,MatrixMath.reusePerspectiveCommand,[value]);break;case'rotateX':_multiplyTransform(result,MatrixMath.reuseRotateXCommand,[_convertToRadians(value)]);break;case'rotateY':_multiplyTransform(result,MatrixMath.reuseRotateYCommand,[_convertToRadians(value)]);break;case'rotate':case'rotateZ':_multiplyTransform(result,MatrixMath.reuseRotateZCommand,[_convertToRadians(value)]);break;case'scale':_multiplyTransform(result,MatrixMath.reuseScaleCommand,[value]);break;case'scaleX':_multiplyTransform(result,MatrixMath.reuseScaleXCommand,[value]);break;case'scaleY':_multiplyTransform(result,MatrixMath.reuseScaleYCommand,[value]);break;case'translate':_multiplyTransform(result,MatrixMath.reuseTranslate3dCommand,[value[0],value[1],value[2]||0]);break;case'translateX':_multiplyTransform(result,MatrixMath.reuseTranslate2dCommand,[value,0]);break;case'translateY':_multiplyTransform(result,MatrixMath.reuseTranslate2dCommand,[0,value]);break;case'skewX':_multiplyTransform(result,MatrixMath.reuseSkewXCommand,[_convertToRadians(value)]);break;case'skewY':_multiplyTransform(result,MatrixMath.reuseSkewYCommand,[_convertToRadians(value)]);break;default:throw new Error('Invalid transform name: '+key);}});return result;}function _multiplyTransform(result,matrixMathFunction,args){var matrixToApply=MatrixMath.createIdentityMatrix();var argsWithIdentity=[matrixToApply].concat(args);matrixMathFunction.apply(this,argsWithIdentity);MatrixMath.multiplyInto(result,result,matrixToApply);}function _convertToRadians(value){var floatValue=parseFloat(value);return value.indexOf('rad')>-1?floatValue:floatValue*Math.PI/180;}function _validateTransforms(transform){transform.forEach(function(transformation){var keys=Object.keys(transformation);invariant(keys.length===1,'You must specify exactly one property per transform object. Passed properties: %s',stringifySafe(transformation));var key=keys[0];var value=transformation[key];_validateTransform(key,value,transformation);});}function _validateTransform(key,value,transformation){invariant(!value.getValue,'You passed an Animated.Value to a normal component. '+'You need to wrap that component in an Animated. For example, '+'replace <View /> by <Animated.View />.');var multivalueTransforms=['matrix','translate'];if(multivalueTransforms.indexOf(key)!==-1){invariant(Array.isArray(value),'Transform with key of %s must have an array as the value: %s',key,stringifySafe(transformation));}switch(key){case'matrix':invariant(value.length===9||value.length===16,'Matrix transform must have a length of 9 (2d) or 16 (3d). '+'Provided matrix has a length of %s: %s',value.length,stringifySafe(transformation));break;case'translate':invariant(value.length===2||value.length===3,'Transform with key translate must be an array of length 2 or 3, found %s: %s',value.length,stringifySafe(transformation));break;case'rotateX':case'rotateY':case'rotateZ':case'rotate':case'skewX':case'skewY':invariant(typeof value==='string','Transform with key of "%s" must be a string: %s',key,stringifySafe(transformation));invariant(value.indexOf('deg')>-1||value.indexOf('rad')>-1,'Rotate transform must be expressed in degrees (deg) or radians '+'(rad): %s',stringifySafe(transformation));break;case'perspective':invariant(typeof value==='number','Transform with key of "%s" must be a number: %s',key,stringifySafe(transformation));invariant(value!==0,'Transform with key of "%s" cannot be zero: %s',key,stringifySafe(transformation));break;case'translateX':case'translateY':case'scale':case'scaleX':case'scaleY':invariant(typeof value==='number','Transform with key of "%s" must be a number: %s',key,stringifySafe(transformation));break;default:invariant(false,'Invalid transform %s: %s',key,stringifySafe(transformation));}}module.exports=processTransform;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2Nlc3NUcmFuc2Zvcm0uanMiXSwibmFtZXMiOlsiTWF0cml4TWF0aCIsInJlcXVpcmUiLCJQbGF0Zm9ybSIsImludmFyaWFudCIsInN0cmluZ2lmeVNhZmUiLCJwcm9jZXNzVHJhbnNmb3JtIiwidHJhbnNmb3JtIiwiX19ERVZfXyIsIl92YWxpZGF0ZVRyYW5zZm9ybXMiLCJPUyIsInJlc3VsdCIsImNyZWF0ZUlkZW50aXR5TWF0cml4IiwiZm9yRWFjaCIsImtleSIsIk9iamVjdCIsImtleXMiLCJ0cmFuc2Zvcm1hdGlvbiIsInZhbHVlIiwibXVsdGlwbHlJbnRvIiwiX211bHRpcGx5VHJhbnNmb3JtIiwicmV1c2VQZXJzcGVjdGl2ZUNvbW1hbmQiLCJyZXVzZVJvdGF0ZVhDb21tYW5kIiwiX2NvbnZlcnRUb1JhZGlhbnMiLCJyZXVzZVJvdGF0ZVlDb21tYW5kIiwicmV1c2VSb3RhdGVaQ29tbWFuZCIsInJldXNlU2NhbGVDb21tYW5kIiwicmV1c2VTY2FsZVhDb21tYW5kIiwicmV1c2VTY2FsZVlDb21tYW5kIiwicmV1c2VUcmFuc2xhdGUzZENvbW1hbmQiLCJyZXVzZVRyYW5zbGF0ZTJkQ29tbWFuZCIsInJldXNlU2tld1hDb21tYW5kIiwicmV1c2VTa2V3WUNvbW1hbmQiLCJFcnJvciIsIm1hdHJpeE1hdGhGdW5jdGlvbiIsImFyZ3MiLCJtYXRyaXhUb0FwcGx5IiwiYXJnc1dpdGhJZGVudGl0eSIsImNvbmNhdCIsImFwcGx5IiwiZmxvYXRWYWx1ZSIsInBhcnNlRmxvYXQiLCJpbmRleE9mIiwiTWF0aCIsIlBJIiwibGVuZ3RoIiwiX3ZhbGlkYXRlVHJhbnNmb3JtIiwiZ2V0VmFsdWUiLCJtdWx0aXZhbHVlVHJhbnNmb3JtcyIsIkFycmF5IiwiaXNBcnJheSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQVNBLGFBRUEsR0FBSUEsWUFBYUMsT0FBYixjQUFKLENBQ0EsR0FBSUMsVUFBV0QsT0FBWCxZQUFKLENBRUEsR0FBSUUsV0FB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Q0FDQSxJQUFLLFlBQUwsQ0FDQSxJQUFLLE9BQUwsQ0FDQSxJQUFLLFFBQUwsQ0FDQSxJQUFLLFFBQUwsQ0FDRWIsVUFDRSxNQUFPYyxNQUFQLEdBQWlCLFFBRG5CLENBRUUsaURBRkYsQ0FHRUosR0FIRixDQUlFVCxjQUFjWSxjQUFkLENBSkYsRUFNQSxNQUNGLFFBQ0ViLFVBQVUsS0FBVixDQUFpQiwwQkFBakIsQ0FBNkNVLEdBQTdDLENBQWtEVCxjQUFjWSxjQUFkLENBQWxELEVBaEVKLENBa0VELENBRURrQyxPQUFPQyxPQUFQLENBQWlCOUMsZ0JBQWpCIiwiZmlsZSI6InByb2Nlc3NUcmFuc2Zvcm0uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBwcm92aWRlc01vZHVsZSBwcm9jZXNzVHJhbnNmb3JtXG4gKiBAZmxvd1xuICovXG4ndXNlIHN0cmljdCc7XG5cbnZhciBNYXRyaXhNYXRoID0gcmVxdWlyZSgnTWF0cml4TWF0aCcpO1xudmFyIFBsYXRmb3JtID0gcmVxdWlyZSgnUGxhdGZvcm0nKTtcblxudmFyIGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xudmFyIHN0cmluZ2lmeVNhZmUgPSByZXF1aXJlKCdzdHJpbmdpZnlTYWZlJyk7XG5cbi8qKlxuICogR2VuZXJhdGUgYSB0cmFuc2Zvcm0gbWF0cml4IGJhc2VkIG9uIHRoZSBwcm92aWRlZCB0cmFuc2Zvcm1zLCBhbmQgdXNlIHRoYXRcbiAqIHdpdGhpbiB0aGUgc3R5bGUgb2JqZWN0IGluc3RlYWQuXG4gKlxuICogVGhpcyBhbGxvd3MgdXMgdG8gcHJvdmlkZSBhbiBBUEkgdGhhdCBpcyBzaW1pbGFyIHRvIENTUywgd2hlcmUgdHJhbnNmb3JtcyBtYXlcbiAqIGJlIGFwcGxpZWQgaW4gYW4gYXJiaXRyYXJ5IG9yZGVyLCBhbmQgeWV0IGhhdmUgYSB1bml2ZXJzYWwsIHNpbmd1bGFyXG4gKiBpbnRlcmZhY2UgdG8gbmF0aXZlIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NUcmFuc2Zvcm0odHJhbnNmb3JtOiBBcnJheTxPYmplY3Q+KTogQXJyYXk8T2JqZWN0PiB8IEFycmF5PG51bWJlcj4ge1xuICBpZiAoX19ERVZfXykge1xuICAgIF92YWxpZGF0ZVRyYW5zZm9ybXModHJhbnNmb3JtKTtcbiAgfVxuXG4gIC8vIEFuZHJvaWQgJiBpT1MgaW1wbGVtZW50YXRpb25zIG9mIHRyYW5zZm9ybSBwcm9wZXJ0eSBhY2NlcHQgdGhlIGxpc3Qgb2ZcbiAgLy8gdHJhbnNmb3JtIHByb3BlcnRpZXMgYXMgb3Bwb3NlZCB0byBhIHRyYW5zZm9ybSBNYXRyaXguIFRoaXMgaXMgbmVjZXNzYXJ5XG4gIC8vIHRvIGNvbnRyb2wgdHJhbnNmb3JtIHByb3BlcnR5IHVwZGF0ZXMgY29tcGxldGVseSBvbiB0aGUgbmF0aXZlIHRocmVhZC5cbiAgaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcgfHwgUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgcmV0dXJuIHRyYW5zZm9ybTtcbiAgfVxuXG4gIHZhciByZXN1bHQgPSBNYXRyaXhNYXRoLmNyZWF0ZUlkZW50aXR5TWF0cml4KCk7XG5cbiAgdHJhbnNmb3JtLmZvckVhY2godHJhbnNmb3JtYXRpb24gPT4ge1xuICAgIHZhciBrZXkgPSBPYmplY3Qua2V5cyh0cmFuc2Zvcm1hdGlvbilbMF07XG4gICAgdmFyIHZhbHVlID0gdHJhbnNmb3JtYXRpb25ba2V5XTtcblxuICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICBjYXNlICdtYXRyaXgnOlxuICAgICAgICBNYXRyaXhNYXRoLm11bHRpcGx5SW50byhyZXN1bHQsIHJlc3VsdCwgdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3BlcnNwZWN0aXZlJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVBlcnNwZWN0aXZlQ29tbWFuZCwgW3ZhbHVlXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncm90YXRlWCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VSb3RhdGVYQ29tbWFuZCwgW19jb252ZXJ0VG9SYWRpYW5zKHZhbHVlKV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JvdGF0ZVknOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlUm90YXRlWUNvbW1hbmQsIFtfY29udmVydFRvUmFkaWFucyh2YWx1ZSldKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyb3RhdGUnOlxuICAgICAgY2FzZSAncm90YXRlWic6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VSb3RhdGVaQ29tbWFuZCwgW19jb252ZXJ0VG9SYWRpYW5zKHZhbHVlKV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NjYWxlJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVNjYWxlQ29tbWFuZCwgW3ZhbHVlXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc2NhbGVYJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVNjYWxlWENvbW1hbmQsIFt2YWx1ZV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NjYWxlWSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTY2FsZVlDb21tYW5kLCBbdmFsdWVdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0cmFuc2xhdGUnOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlVHJhbnNsYXRlM2RDb21tYW5kLCBbdmFsdWVbMF0sIHZhbHVlWzFdLCB2YWx1ZVsyXSB8fCAwXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndHJhbnNsYXRlWCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VUcmFuc2xhdGUyZENvbW1hbmQsIFt2YWx1ZSwgMF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RyYW5zbGF0ZVknOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlVHJhbnNsYXRlMmRDb21tYW5kLCBbMCwgdmFsdWVdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdza2V3WCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTa2V3WENvbW1hbmQsIFtfY29udmVydFRvUmFkaWFucyh2YWx1ZSldKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdza2V3WSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTa2V3WUNvbW1hbmQsIFtfY29udmVydFRvUmFkaWFucyh2YWx1ZSldKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdHJhbnNmb3JtIG5hbWU6ICcgKyBrZXkpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBQZXJmb3JtcyBhIGRlc3RydWN0aXZlIG9wZXJhdGlvbiBvbiBhIHRyYW5zZm9ybSBtYXRyaXguXG4gKi9cbmZ1bmN0aW9uIF9tdWx0aXBseVRyYW5zZm9ybShcbiAgcmVzdWx0OiBBcnJheTxudW1iZXI+LFxuICBtYXRyaXhNYXRoRnVuY3Rpb246IEZ1bmN0aW9uLFxuICBhcmdzOiBBcnJheTxudW1iZXI+XG4pOiB2b2lkIHtcbiAgdmFyIG1hdHJpeFRvQXBwbHkgPSBNYXRyaXhNYXRoLmNyZWF0ZUlkZW50aXR5TWF0cml4KCk7XG4gIHZhciBhcmdzV2l0aElkZW50aXR5ID0gW21hdHJpeFRvQXBwbHldLmNvbmNhdChhcmdzKTtcbiAgbWF0cml4TWF0aEZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3NXaXRoSWRlbnRpdHkpO1xuICBNYXRyaXhNYXRoLm11bHRpcGx5SW50byhyZXN1bHQsIHJlc3VsdCwgbWF0cml4VG9BcHBseSk7XG59XG5cbi8qKlxuICogUGFyc2VzIGEgc3RyaW5nIGxpa2UgJzAuNXJhZCcgb3IgJzYwZGVnJyBpbnRvIHJhZGlhbnMgZXhwcmVzc2VkIGluIGEgZmxvYXQuXG4gKiBOb3RlIHRoYXQgdmFsaWRhdGlvbiBvbiB0aGUgc3RyaW5nIGlzIGRvbmUgaW4gYF92YWxpZGF0ZVRyYW5zZm9ybSgpYC5cbiAqL1xuZnVuY3Rpb24gX2NvbnZlcnRUb1JhZGlhbnModmFsdWU6IHN0cmluZyk6IG51bWJlciB7XG4gIHZhciBmbG9hdFZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gIHJldHVybiB2YWx1ZS5pbmRleE9mKCdyYWQnKSA+IC0xID8gZmxvYXRWYWx1ZSA6IGZsb2F0VmFsdWUgKiBNYXRoLlBJIC8gMTgwO1xufVxuXG5mdW5jdGlvbiBfdmFsaWRhdGVUcmFuc2Zvcm1zKHRyYW5zZm9ybTogQXJyYXk8T2JqZWN0Pik6IHZvaWQge1xuICB0cmFuc2Zvcm0uZm9yRWFjaCh0cmFuc2Zvcm1hdGlvbiA9PiB7XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0cmFuc2Zvcm1hdGlvbik7XG4gICAgaW52YXJpYW50KFxuICAgICAga2V5cy5sZW5ndGggPT09IDEsXG4gICAgICAnWW91IG11c3Qgc3BlY2lmeSBleGFjdGx5IG9uZSBwcm9wZXJ0eSBwZXIgdHJhbnNmb3JtIG9iamVjdC4gUGFzc2VkIHByb3BlcnRpZXM6ICVzJyxcbiAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICk7XG4gICAgdmFyIGtleSA9IGtleXNbMF07XG4gICAgdmFyIHZhbHVlID0gdHJhbnNmb3JtYXRpb25ba2V5XTtcbiAgICBfdmFsaWRhdGVUcmFuc2Zvcm0oa2V5LCB2YWx1ZSwgdHJhbnNmb3JtYXRpb24pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gX3ZhbGlkYXRlVHJhbnNmb3JtKGtleSwgdmFsdWUsIHRyYW5zZm9ybWF0aW9uKSB7XG4gIGludmFyaWFudChcbiAgICAhdmFsdWUuZ2V0VmFsdWUsXG4gICAgJ1lvdSBwYXNzZWQgYW4gQW5pbWF0ZWQuVmFsdWUgdG8gYSBub3JtYWwgY29tcG9uZW50LiAnICtcbiAgICAnWW91IG5lZWQgdG8gd3JhcCB0aGF0IGNvbXBvbmVudCBpbiBhbiBBbmltYXRlZC4gRm9yIGV4YW1wbGUsICcgK1xuICAgICdyZXBsYWNlIDxWaWV3IC8+IGJ5IDxBbmltYXRlZC5WaWV3IC8+LidcbiAgKTtcblxuICB2YXIgbXVsdGl2YWx1ZVRyYW5zZm9ybXMgPSBbXG4gICAgJ21hdHJpeCcsXG4gICAgJ3RyYW5zbGF0ZScsXG4gIF07XG4gIGlmIChtdWx0aXZhbHVlVHJhbnNmb3Jtcy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgQXJyYXkuaXNBcnJheSh2YWx1ZSksXG4gICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mICVzIG11c3QgaGF2ZSBhbiBhcnJheSBhcyB0aGUgdmFsdWU6ICVzJyxcbiAgICAgIGtleSxcbiAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICk7XG4gIH1cbiAgc3dpdGNoIChrZXkpIHtcbiAgICBjYXNlICdtYXRyaXgnOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB2YWx1ZS5sZW5ndGggPT09IDkgfHwgdmFsdWUubGVuZ3RoID09PSAxNixcbiAgICAgICAgJ01hdHJpeCB0cmFuc2Zvcm0gbXVzdCBoYXZlIGEgbGVuZ3RoIG9mIDkgKDJkKSBvciAxNiAoM2QpLiAnICtcbiAgICAgICAgICAnUHJvdmlkZWQgbWF0cml4IGhhcyBhIGxlbmd0aCBvZiAlczogJXMnLFxuICAgICAgICB2YWx1ZS5sZW5ndGgsXG4gICAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICAgKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RyYW5zbGF0ZSc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlLmxlbmd0aCA9PT0gMiB8fCB2YWx1ZS5sZW5ndGggPT09IDMsXG4gICAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgdHJhbnNsYXRlIG11c3QgYmUgYW4gYXJyYXkgb2YgbGVuZ3RoIDIgb3IgMywgZm91bmQgJXM6ICVzJyxcbiAgICAgICAgdmFsdWUubGVuZ3RoLFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdyb3RhdGVYJzpcbiAgICBjYXNlICdyb3RhdGVZJzpcbiAgICBjYXNlICdyb3RhdGVaJzpcbiAgICBjYXNlICdyb3RhdGUnOlxuICAgIGNhc2UgJ3NrZXdYJzpcbiAgICBjYXNlICdza2V3WSc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycsXG4gICAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgb2YgXCIlc1wiIG11c3QgYmUgYSBzdHJpbmc6ICVzJyxcbiAgICAgICAga2V5LFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlLmluZGV4T2YoJ2RlZycpID4gLTEgfHwgdmFsdWUuaW5kZXhPZigncmFkJykgPiAtMSxcbiAgICAgICAgJ1JvdGF0ZSB0cmFuc2Zvcm0gbXVzdCBiZSBleHByZXNzZWQgaW4gZGVncmVlcyAoZGVnKSBvciByYWRpYW5zICcgK1xuICAgICAgICAgICcocmFkKTogJXMnLFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdwZXJzcGVjdGl2ZSc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicsXG4gICAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgb2YgXCIlc1wiIG11c3QgYmUgYSBudW1iZXI6ICVzJyxcbiAgICAgICAga2V5LFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlICE9PSAwLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBjYW5ub3QgYmUgemVybzogJXMnLFxuICAgICAgICBrZXksXG4gICAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICAgKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RyYW5zbGF0ZVgnOlxuICAgIGNhc2UgJ3RyYW5zbGF0ZVknOlxuICAgIGNhc2UgJ3NjYWxlJzpcbiAgICBjYXNlICdzY2FsZVgnOlxuICAgIGNhc2UgJ3NjYWxlWSc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicsXG4gICAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgb2YgXCIlc1wiIG11c3QgYmUgYSBudW1iZXI6ICVzJyxcbiAgICAgICAga2V5LFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgaW52YXJpYW50KGZhbHNlLCAnSW52YWxpZCB0cmFuc2Zvcm0gJXM6ICVzJywga2V5LCBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBwcm9jZXNzVHJhbnNmb3JtO1xuIl19