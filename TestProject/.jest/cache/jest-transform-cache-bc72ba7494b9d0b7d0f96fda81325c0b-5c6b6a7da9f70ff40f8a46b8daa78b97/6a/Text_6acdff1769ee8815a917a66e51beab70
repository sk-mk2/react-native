d2ea60bf6e4c80cf0e344a8d5b5de325
'use strict';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var NativeMethodsMixin=require('NativeMethodsMixin');var React=require('React');var ReactNativeViewAttributes=require('ReactNativeViewAttributes');var TextPropTypes=require('TextPropTypes');var Touchable=require('Touchable');var UIManager=require('UIManager');var createReactClass=require('create-react-class');var createReactNativeComponentClass=require('createReactNativeComponentClass');var mergeFast=require('mergeFast');var processColor=require('processColor');var _require=require('ViewContext'),ViewContextTypes=_require.ViewContextTypes;var viewConfig={validAttributes:mergeFast(ReactNativeViewAttributes.UIView,{isHighlighted:true,numberOfLines:true,ellipsizeMode:true,allowFontScaling:true,disabled:true,selectable:true,selectionColor:true,adjustsFontSizeToFit:true,minimumFontScale:true,textBreakStrategy:true}),uiViewClassName:'RCTText'};var Text=createReactClass({displayName:'Text',propTypes:TextPropTypes,getDefaultProps:function getDefaultProps(){return{accessible:true,allowFontScaling:true,ellipsizeMode:'tail'};},getInitialState:function getInitialState(){return mergeFast(Touchable.Mixin.touchableGetInitialState(),{isHighlighted:false});},mixins:[NativeMethodsMixin],viewConfig:viewConfig,getChildContext:function getChildContext(){return{isInAParentText:true};},childContextTypes:ViewContextTypes,contextTypes:ViewContextTypes,_handlers:null,_hasPressHandler:function _hasPressHandler(){return!!this.props.onPress||!!this.props.onLongPress;},touchableHandleActivePressIn:null,touchableHandleActivePressOut:null,touchableHandlePress:null,touchableHandleLongPress:null,touchableGetPressRectOffset:null,render:function render(){var _this=this;var newProps=this.props;if(this.props.onStartShouldSetResponder||this._hasPressHandler()){if(!this._handlers){this._handlers={onStartShouldSetResponder:function onStartShouldSetResponder(){var shouldSetFromProps=_this.props.onStartShouldSetResponder&&_this.props.onStartShouldSetResponder();var setResponder=shouldSetFromProps||_this._hasPressHandler();if(setResponder&&!_this.touchableHandleActivePressIn){for(var key in Touchable.Mixin){if(typeof Touchable.Mixin[key]==='function'){_this[key]=Touchable.Mixin[key].bind(_this);}}_this.touchableHandleActivePressIn=function(){if(_this.props.suppressHighlighting||!_this._hasPressHandler()){return;}_this.setState({isHighlighted:true});};_this.touchableHandleActivePressOut=function(){if(_this.props.suppressHighlighting||!_this._hasPressHandler()){return;}_this.setState({isHighlighted:false});};_this.touchableHandlePress=function(e){_this.props.onPress&&_this.props.onPress(e);};_this.touchableHandleLongPress=function(e){_this.props.onLongPress&&_this.props.onLongPress(e);};_this.touchableGetPressRectOffset=function(){return this.props.pressRetentionOffset||PRESS_RECT_OFFSET;};}return setResponder;},onResponderGrant:function(e,dispatchID){this.touchableHandleResponderGrant(e,dispatchID);this.props.onResponderGrant&&this.props.onResponderGrant.apply(this,arguments);}.bind(this),onResponderMove:function(e){this.touchableHandleResponderMove(e);this.props.onResponderMove&&this.props.onResponderMove.apply(this,arguments);}.bind(this),onResponderRelease:function(e){this.touchableHandleResponderRelease(e);this.props.onResponderRelease&&this.props.onResponderRelease.apply(this,arguments);}.bind(this),onResponderTerminate:function(e){this.touchableHandleResponderTerminate(e);this.props.onResponderTerminate&&this.props.onResponderTerminate.apply(this,arguments);}.bind(this),onResponderTerminationRequest:function(){var allowTermination=this.touchableHandleResponderTerminationRequest();if(allowTermination&&this.props.onResponderTerminationRequest){allowTermination=this.props.onResponderTerminationRequest.apply(this,arguments);}return allowTermination;}.bind(this)};}newProps=_extends({},this.props,this._handlers,{isHighlighted:this.state.isHighlighted});}if(newProps.selectionColor!=null){newProps=_extends({},newProps,{selectionColor:processColor(newProps.selectionColor)});}if(Touchable.TOUCH_TARGET_DEBUG&&newProps.onPress){newProps=_extends({},newProps,{style:[this.props.style,{color:'magenta'}]});}if(this.context.isInAParentText){return React.createElement(RCTVirtualText,newProps);}else{return React.createElement(RCTText,newProps);}}});var PRESS_RECT_OFFSET={top:20,left:20,right:20,bottom:30};var RCTText=createReactNativeComponentClass(viewConfig.uiViewClassName,function(){return viewConfig;});var RCTVirtualText=RCTText;if(UIManager.RCTVirtualText){RCTVirtualText=createReactNativeComponentClass('RCTVirtualText',function(){return{validAttributes:mergeFast(ReactNativeViewAttributes.UIView,{isHighlighted:true}),uiViewClassName:'RCTVirtualText'};});}module.exports=Text;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRleHQuanMiXSwibmFtZXMiOlsiTmF0aXZlTWV0aG9kc01peGluIiwicmVxdWlyZSIsIlJlYWN0IiwiUmVhY3ROYXRpdmVWaWV3QXR0cmlidXRlcyIsIlRleHRQcm9wVHlwZXMiLCJUb3VjaGFibGUiLCJVSU1hbmFnZXIiLCJjcmVhdGVSZWFjdENsYXNzIiwiY3JlYXRlUmVhY3ROYXRpdmVDb21wb25lbnRDbGFzcyIsIm1lcmdlRmFzdCIsInByb2Nlc3NDb2xvciIsIlZpZXdDb250ZXh0VHlwZXMiLCJ2aWV3Q29uZmlnIiwidmFsaWRBdHRyaWJ1dGVzIiwiVUlWaWV3IiwiaXNIaWdobGlnaHRlZCIsIm51bWJlck9mTGluZXMiLCJlbGxpcHNpemVNb2RlIiwiYWxsb3dGb250U2NhbGluZyIsImRpc2FibGVkIiwic2VsZWN0YWJsZSIsInNlbGVjdGlvbkNvbG9yIiwiYWRqdXN0c0ZvbnRTaXplVG9GaXQiLCJtaW5pbXVtRm9udFNjYWxlIiwidGV4dEJyZWFrU3RyYXRlZ3kiLCJ1aVZpZXdDbGFzc05hbWUiLCJUZXh0IiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJnZXREZWZhdWx0UHJvcHMiLCJhY2Nlc3NpYmxlIiwiZ2V0SW5pdGlhbFN0YXRlIiwiTWl4aW4iLCJ0b3VjaGFibGVHZXRJbml0aWFsU3RhdGUiLCJtaXhpbnMiLCJnZXRDaGlsZENvbnRleHQiLCJpc0luQVBhcmVudFRleHQiLCJjaGlsZENvbnRleHRUeXBlcyIsImNvbnRleHRUeXBlcyIsIl9oYW5kbGVycyIsIl9oYXNQcmVzc0hhbmRsZXIiLCJwcm9wcyIsIm9uUHJlc3MiLCJvbkxvbmdQcmVzcyIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzSW4iLCJ0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc091dCIsInRvdWNoYWJsZUhhbmRsZVByZXNzIiwidG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzIiwidG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0IiwicmVuZGVyIiwibmV3UHJvcHMiLCJvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyIiwic2hvdWxkU2V0RnJvbVByb3BzIiwic2V0UmVzcG9uZGVyIiwia2V5IiwiYmluZCIsInN1cHByZXNzSGlnaGxpZ2h0aW5nIiwic2V0U3RhdGUiLCJlIiwicHJlc3NSZXRlbnRpb25PZmZzZXQiLCJQUkVTU19SRUNUX09GRlNFVCIsIm9uUmVzcG9uZGVyR3JhbnQiLCJkaXNwYXRjaElEIiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnQiLCJhcHBseSIsImFyZ3VtZW50cyIsIm9uUmVzcG9uZGVyTW92ZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlck1vdmUiLCJvblJlc3BvbmRlclJlbGVhc2UiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJSZWxlYXNlIiwib25SZXNwb25kZXJUZXJtaW5hdGUiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUiLCJvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsImFsbG93VGVybWluYXRpb24iLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QiLCJzdGF0ZSIsIlRPVUNIX1RBUkdFVF9ERUJVRyIsInN0eWxlIiwiY29sb3IiLCJjb250ZXh0IiwidG9wIiwibGVmdCIsInJpZ2h0IiwiYm90dG9tIiwiUkNUVGV4dCIsIlJDVFZpcnR1YWxUZXh0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUEsYSxnT0FFQSxHQUFNQSxvQkFBcUJDLE9BQXJCLHNCQUFOLENBQ0EsR0FBTUMsT0FBUUQsT0FBUixTQUFOLENBQ0EsR0FBTUUsMkJBQTRCRixPQUE1Qiw2QkFBTixDQUNBLEdBQU1HLGVBQWdCSCxPQUFoQixpQkFBTixDQUNBLEdBQU1JLFdBQVlKLE9BQVosYUFBTixDQUNBLEdBQU1LLFdBQVlMLE9BQVosYUFBTixDQUVBLEdBQU1NLGtCQUFtQk4sT0FBbkIsc0JBQU4sQ0FDQSxHQUFNTyxpQ0FBa0NQLE9BQWxDLG1DQUFOLENBQ0EsR0FBTVEs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Q0FDRCxHQUFJaEIsVUFBVXVFLGtCQUFWLEVBQWdDMUIsU0FBU1IsT0FBN0MsQ0FBc0QsQ0FDcERRLHFCQUNLQSxRQURMLEVBRUUyQixNQUFPLENBQUMsS0FBS3BDLEtBQUwsQ0FBV29DLEtBQVosQ0FBbUIsQ0FBQ0MsTUFBTyxTQUFSLENBQW5CLENBRlQsR0FJRCxDQUNELEdBQUksS0FBS0MsT0FBTCxDQUFhM0MsZUFBakIsQ0FBa0MsQ0FDaEMsTUFBTyxxQkFBQyxjQUFELENBQW9CYyxRQUFwQixDQUFQLENBQ0QsQ0FGRCxJQUVPLENBQ0wsTUFBTyxxQkFBQyxPQUFELENBQWFBLFFBQWIsQ0FBUCxDQUNELENBQ0YsQ0ExSjJCLENBQWpCLENBQWIsQ0FvS0EsR0FBSVUsbUJBQW9CLENBQUNvQixJQUFLLEVBQU4sQ0FBVUMsS0FBTSxFQUFoQixDQUFvQkMsTUFBTyxFQUEzQixDQUErQkMsT0FBUSxFQUF2QyxDQUF4QixDQUVBLEdBQUlDLFNBQVU1RSxnQ0FDWkksV0FBV2EsZUFEQyxDQUVaLGlCQUFNYixXQUFOLEVBRlksQ0FBZCxDQUlBLEdBQUl5RSxnQkFBaUJELE9BQXJCLENBRUEsR0FBSTlFLFVBQVUrRSxjQUFkLENBQThCLENBQzVCQSxlQUFpQjdFLGdDQUFnQyxnQkFBaEMsQ0FBa0QsaUJBQU8sQ0FDeEVLLGdCQUFpQkosVUFBVU4sMEJBQTBCVyxNQUFwQyxDQUE0QyxDQUMzREMsY0FBZSxJQUQ0QyxDQUE1QyxDQUR1RCxDQUl4RVUsZ0JBQWlCLGdCQUp1RCxDQUFQLEVBQWxELENBQWpCLENBTUQsQ0FFRDZELE9BQU9DLE9BQVAsQ0FBaUI3RCxJQUFqQiIsImZpbGUiOiJUZXh0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAcHJvdmlkZXNNb2R1bGUgVGV4dFxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBOYXRpdmVNZXRob2RzTWl4aW4gPSByZXF1aXJlKCdOYXRpdmVNZXRob2RzTWl4aW4nKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgnUmVhY3QnKTtcbmNvbnN0IFJlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMgPSByZXF1aXJlKCdSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzJyk7XG5jb25zdCBUZXh0UHJvcFR5cGVzID0gcmVxdWlyZSgnVGV4dFByb3BUeXBlcycpO1xuY29uc3QgVG91Y2hhYmxlID0gcmVxdWlyZSgnVG91Y2hhYmxlJyk7XG5jb25zdCBVSU1hbmFnZXIgPSByZXF1aXJlKCdVSU1hbmFnZXInKTtcblxuY29uc3QgY3JlYXRlUmVhY3RDbGFzcyA9IHJlcXVpcmUoJ2NyZWF0ZS1yZWFjdC1jbGFzcycpO1xuY29uc3QgY3JlYXRlUmVhY3ROYXRpdmVDb21wb25lbnRDbGFzcyA9IHJlcXVpcmUoJ2NyZWF0ZVJlYWN0TmF0aXZlQ29tcG9uZW50Q2xhc3MnKTtcbmNvbnN0IG1lcmdlRmFzdCA9IHJlcXVpcmUoJ21lcmdlRmFzdCcpO1xuY29uc3QgcHJvY2Vzc0NvbG9yID0gcmVxdWlyZSgncHJvY2Vzc0NvbG9yJyk7XG5jb25zdCB7Vmlld0NvbnRleHRUeXBlc30gPSByZXF1aXJlKCdWaWV3Q29udGV4dCcpO1xuXG5jb25zdCB2aWV3Q29uZmlnID0ge1xuICB2YWxpZEF0dHJpYnV0ZXM6IG1lcmdlRmFzdChSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzLlVJVmlldywge1xuICAgIGlzSGlnaGxpZ2h0ZWQ6IHRydWUsXG4gICAgbnVtYmVyT2ZMaW5lczogdHJ1ZSxcbiAgICBlbGxpcHNpemVNb2RlOiB0cnVlLFxuICAgIGFsbG93Rm9udFNjYWxpbmc6IHRydWUsXG4gICAgZGlzYWJsZWQ6IHRydWUsXG4gICAgc2VsZWN0YWJsZTogdHJ1ZSxcbiAgICBzZWxlY3Rpb25Db2xvcjogdHJ1ZSxcbiAgICBhZGp1c3RzRm9udFNpemVUb0ZpdDogdHJ1ZSxcbiAgICBtaW5pbXVtRm9udFNjYWxlOiB0cnVlLFxuICAgIHRleHRCcmVha1N0cmF0ZWd5OiB0cnVlLFxuICB9KSxcbiAgdWlWaWV3Q2xhc3NOYW1lOiAnUkNUVGV4dCcsXG59O1xuXG5pbXBvcnQgdHlwZSB7Vmlld0NoaWxkQ29udGV4dH0gZnJvbSAnVmlld0NvbnRleHQnO1xuXG4vKipcbiAqIEEgUmVhY3QgY29tcG9uZW50IGZvciBkaXNwbGF5aW5nIHRleHQuXG4gKlxuICogU2VlIGh0dHBzOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL3RleHQuaHRtbFxuICovXG5cbmNvbnN0IFRleHQgPSBjcmVhdGVSZWFjdENsYXNzKHtcbiAgZGlzcGxheU5hbWU6ICdUZXh0JyxcbiAgcHJvcFR5cGVzOiBUZXh0UHJvcFR5cGVzLFxuICBnZXREZWZhdWx0UHJvcHMoKTogT2JqZWN0IHtcbiAgICByZXR1cm4ge1xuICAgICAgYWNjZXNzaWJsZTogdHJ1ZSxcbiAgICAgIGFsbG93Rm9udFNjYWxpbmc6IHRydWUsXG4gICAgICBlbGxpcHNpemVNb2RlOiAndGFpbCcsXG4gICAgfTtcbiAgfSxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpOiBPYmplY3Qge1xuICAgIHJldHVybiBtZXJnZUZhc3QoVG91Y2hhYmxlLk1peGluLnRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSgpLCB7XG4gICAgICBpc0hpZ2hsaWdodGVkOiBmYWxzZSxcbiAgICB9KTtcbiAgfSxcbiAgbWl4aW5zOiBbTmF0aXZlTWV0aG9kc01peGluXSxcbiAgdmlld0NvbmZpZzogdmlld0NvbmZpZyxcbiAgZ2V0Q2hpbGRDb250ZXh0KCk6IFZpZXdDaGlsZENvbnRleHQge1xuICAgIHJldHVybiB7XG4gICAgICBpc0luQVBhcmVudFRleHQ6IHRydWUsXG4gICAgfTtcbiAgfSxcbiAgY2hpbGRDb250ZXh0VHlwZXM6IFZpZXdDb250ZXh0VHlwZXMsXG4gIGNvbnRleHRUeXBlczogVmlld0NvbnRleHRUeXBlcyxcbiAgLyoqXG4gICAqIE9ubHkgYXNzaWduZWQgaWYgdG91Y2ggaXMgbmVlZGVkLlxuICAgKi9cbiAgX2hhbmRsZXJzOiAobnVsbDogP09iamVjdCksXG4gIF9oYXNQcmVzc0hhbmRsZXIoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5wcm9wcy5vblByZXNzIHx8ICEhdGhpcy5wcm9wcy5vbkxvbmdQcmVzcztcbiAgfSxcbiAgLyoqXG4gICAqIFRoZXNlIGFyZSBhc3NpZ25lZCBsYXppbHkgdGhlIGZpcnN0IHRpbWUgdGhlIHJlc3BvbmRlciBpcyBzZXQgdG8gbWFrZSBwbGFpblxuICAgKiB0ZXh0IG5vZGVzIGFzIGNoZWFwIGFzIHBvc3NpYmxlLlxuICAgKi9cbiAgdG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NJbjogKG51bGw6ID9GdW5jdGlvbiksXG4gIHRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0OiAobnVsbDogP0Z1bmN0aW9uKSxcbiAgdG91Y2hhYmxlSGFuZGxlUHJlc3M6IChudWxsOiA/RnVuY3Rpb24pLFxuICB0b3VjaGFibGVIYW5kbGVMb25nUHJlc3M6IChudWxsOiA/RnVuY3Rpb24pLFxuICB0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQ6IChudWxsOiA/RnVuY3Rpb24pLFxuICByZW5kZXIoKTogUmVhY3QuRWxlbWVudDxhbnk+IHtcbiAgICBsZXQgbmV3UHJvcHMgPSB0aGlzLnByb3BzO1xuICAgIGlmICh0aGlzLnByb3BzLm9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXIgfHwgdGhpcy5faGFzUHJlc3NIYW5kbGVyKCkpIHtcbiAgICAgIGlmICghdGhpcy5faGFuZGxlcnMpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlcnMgPSB7XG4gICAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcjogKCk6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2hvdWxkU2V0RnJvbVByb3BzID1cbiAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyICYmXG4gICAgICAgICAgICAgIC8vICRGbG93Rml4TWUoPj0wLjQxLjApXG4gICAgICAgICAgICAgIHRoaXMucHJvcHMub25TdGFydFNob3VsZFNldFJlc3BvbmRlcigpO1xuICAgICAgICAgICAgY29uc3Qgc2V0UmVzcG9uZGVyID0gc2hvdWxkU2V0RnJvbVByb3BzIHx8IHRoaXMuX2hhc1ByZXNzSGFuZGxlcigpO1xuICAgICAgICAgICAgaWYgKHNldFJlc3BvbmRlciAmJiAhdGhpcy50b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luKSB7XG4gICAgICAgICAgICAgIC8vIEF0dGFjaCBhbmQgYmluZCBhbGwgdGhlIG90aGVyIGhhbmRsZXJzIG9ubHkgdGhlIGZpcnN0IHRpbWUgYSB0b3VjaFxuICAgICAgICAgICAgICAvLyBhY3R1YWxseSBoYXBwZW5zLlxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBUb3VjaGFibGUuTWl4aW4pIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIFRvdWNoYWJsZS5NaXhpbltrZXldID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAodGhpczogYW55KVtrZXldID0gVG91Y2hhYmxlLk1peGluW2tleV0uYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy50b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuc3VwcHJlc3NIaWdobGlnaHRpbmcgfHxcbiAgICAgICAgICAgICAgICAgICF0aGlzLl9oYXNQcmVzc0hhbmRsZXIoKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIGlzSGlnaGxpZ2h0ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgdGhpcy50b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc091dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnN1cHByZXNzSGlnaGxpZ2h0aW5nIHx8XG4gICAgICAgICAgICAgICAgICAhdGhpcy5faGFzUHJlc3NIYW5kbGVyKClcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICBpc0hpZ2hsaWdodGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZVByZXNzID0gKGU6IFN5bnRoZXRpY0V2ZW50PD4pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uUHJlc3MgJiYgdGhpcy5wcm9wcy5vblByZXNzKGUpO1xuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIHRoaXMudG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzID0gKGU6IFN5bnRoZXRpY0V2ZW50PD4pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzICYmIHRoaXMucHJvcHMub25Mb25nUHJlc3MoZSk7XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgdGhpcy50b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQgPSBmdW5jdGlvbigpOiBSZWN0T2Zmc2V0IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5wcmVzc1JldGVudGlvbk9mZnNldCB8fCBQUkVTU19SRUNUX09GRlNFVDtcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZXRSZXNwb25kZXI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBvblJlc3BvbmRlckdyYW50OiBmdW5jdGlvbihlOiBTeW50aGV0aWNFdmVudDw+LCBkaXNwYXRjaElEOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIHRoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnQoZSwgZGlzcGF0Y2hJRCk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyR3JhbnQgJiZcbiAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblJlc3BvbmRlckdyYW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICAgIG9uUmVzcG9uZGVyTW92ZTogZnVuY3Rpb24oZTogU3ludGhldGljRXZlbnQ8Pikge1xuICAgICAgICAgICAgdGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJNb3ZlKGUpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5vblJlc3BvbmRlck1vdmUgJiZcbiAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblJlc3BvbmRlck1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgb25SZXNwb25kZXJSZWxlYXNlOiBmdW5jdGlvbihlOiBTeW50aGV0aWNFdmVudDw+KSB7XG4gICAgICAgICAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2UoZSk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyUmVsZWFzZSAmJlxuICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyUmVsZWFzZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0ZTogZnVuY3Rpb24oZTogU3ludGhldGljRXZlbnQ8Pikge1xuICAgICAgICAgICAgdGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUoZSk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyVGVybWluYXRlICYmXG4gICAgICAgICAgICAgIHRoaXMucHJvcHMub25SZXNwb25kZXJUZXJtaW5hdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICB9LmJpbmQodGhpcyksXG4gICAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q6IGZ1bmN0aW9uKCk6IGJvb2xlYW4ge1xuICAgICAgICAgICAgLy8gQWxsb3cgdG91Y2hhYmxlIG9yIHByb3BzLm9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0IHRvIGRlbnlcbiAgICAgICAgICAgIC8vIHRoZSByZXF1ZXN0XG4gICAgICAgICAgICB2YXIgYWxsb3dUZXJtaW5hdGlvbiA9IHRoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0KCk7XG4gICAgICAgICAgICBpZiAoYWxsb3dUZXJtaW5hdGlvbiAmJiB0aGlzLnByb3BzLm9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0KSB7XG4gICAgICAgICAgICAgIGFsbG93VGVybWluYXRpb24gPSB0aGlzLnByb3BzLm9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0LmFwcGx5KFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzLFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFsbG93VGVybWluYXRpb247XG4gICAgICAgICAgfS5iaW5kKHRoaXMpLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgbmV3UHJvcHMgPSB7XG4gICAgICAgIC4uLnRoaXMucHJvcHMsXG4gICAgICAgIC4uLnRoaXMuX2hhbmRsZXJzLFxuICAgICAgICBpc0hpZ2hsaWdodGVkOiB0aGlzLnN0YXRlLmlzSGlnaGxpZ2h0ZWQsXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobmV3UHJvcHMuc2VsZWN0aW9uQ29sb3IgIT0gbnVsbCkge1xuICAgICAgbmV3UHJvcHMgPSB7XG4gICAgICAgIC4uLm5ld1Byb3BzLFxuICAgICAgICBzZWxlY3Rpb25Db2xvcjogcHJvY2Vzc0NvbG9yKG5ld1Byb3BzLnNlbGVjdGlvbkNvbG9yKSxcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChUb3VjaGFibGUuVE9VQ0hfVEFSR0VUX0RFQlVHICYmIG5ld1Byb3BzLm9uUHJlc3MpIHtcbiAgICAgIG5ld1Byb3BzID0ge1xuICAgICAgICAuLi5uZXdQcm9wcyxcbiAgICAgICAgc3R5bGU6IFt0aGlzLnByb3BzLnN0eWxlLCB7Y29sb3I6ICdtYWdlbnRhJ31dLFxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY29udGV4dC5pc0luQVBhcmVudFRleHQpIHtcbiAgICAgIHJldHVybiA8UkNUVmlydHVhbFRleHQgey4uLm5ld1Byb3BzfSAvPjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDxSQ1RUZXh0IHsuLi5uZXdQcm9wc30gLz47XG4gICAgfVxuICB9LFxufSk7XG5cbnR5cGUgUmVjdE9mZnNldCA9IHtcbiAgdG9wOiBudW1iZXIsXG4gIGxlZnQ6IG51bWJlcixcbiAgcmlnaHQ6IG51bWJlcixcbiAgYm90dG9tOiBudW1iZXIsXG59O1xuXG52YXIgUFJFU1NfUkVDVF9PRkZTRVQgPSB7dG9wOiAyMCwgbGVmdDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMH07XG5cbnZhciBSQ1RUZXh0ID0gY3JlYXRlUmVhY3ROYXRpdmVDb21wb25lbnRDbGFzcyhcbiAgdmlld0NvbmZpZy51aVZpZXdDbGFzc05hbWUsXG4gICgpID0+IHZpZXdDb25maWcsXG4pO1xudmFyIFJDVFZpcnR1YWxUZXh0ID0gUkNUVGV4dDtcblxuaWYgKFVJTWFuYWdlci5SQ1RWaXJ0dWFsVGV4dCkge1xuICBSQ1RWaXJ0dWFsVGV4dCA9IGNyZWF0ZVJlYWN0TmF0aXZlQ29tcG9uZW50Q2xhc3MoJ1JDVFZpcnR1YWxUZXh0JywgKCkgPT4gKHtcbiAgICB2YWxpZEF0dHJpYnV0ZXM6IG1lcmdlRmFzdChSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzLlVJVmlldywge1xuICAgICAgaXNIaWdobGlnaHRlZDogdHJ1ZSxcbiAgICB9KSxcbiAgICB1aVZpZXdDbGFzc05hbWU6ICdSQ1RWaXJ0dWFsVGV4dCcsXG4gIH0pKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBUZXh0O1xuIl19