{"version":3,"sources":["MatrixMath.js"],"names":["invariant","require","MatrixMath","createIdentityMatrix","createCopy","m","createOrthographic","left","right","bottom","top","near","far","a","b","c","tx","ty","tz","createFrustum","r_width","r_height","r_depth","x","y","A","B","C","D","createPerspective","fovInRadians","aspect","h","Math","tan","createTranslate2d","mat","reuseTranslate2dCommand","matrixCommand","reuseTranslate3dCommand","z","createScale","factor","reuseScaleCommand","reuseScale3dCommand","reusePerspectiveCommand","p","reuseScaleXCommand","reuseScaleYCommand","reuseScaleZCommand","reuseRotateXCommand","radians","cos","sin","reuseRotateYCommand","amount","reuseRotateZCommand","createRotateZ","reuseSkewXCommand","reuseSkewYCommand","multiplyInto","out","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b0","b1","b2","b3","determinant","matrix","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","inverse","det","transpose","multiplyVectorByMatrix","v","vx","vy","vz","vw","v3Length","sqrt","v3Normalize","vector","im","v3Dot","v3Combine","aScale","bScale","v3Cross","quaternionToDegreesXYZ","q","row","qx","qy","qz","qw","qw2","qx2","qy2","qz2","test","unit","conv","PI","atan2","roundTo3Places","asin","n","arr","toString","split","round","decomposeMatrix","transformMatrix","length","perspective","quaternion","scale","skew","translation","perspectiveMatrix","i","push","j","value","rightHandSide","inversePerspectiveMatrix","transposedInversePerspectiveMatrix","pdum3","max","rotationDegrees","rotate","rotateX","rotateY","scaleX","scaleY","translateX","translateY","module","exports"],"mappings":"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","file":"MatrixMath.js","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @providesModule MatrixMath\n * @noflow\n */\n/* eslint-disable space-infix-ops */\n'use strict';\n\nvar invariant = require('fbjs/lib/invariant');\n\n/**\n * Memory conservative (mutative) matrix math utilities. Uses \"command\"\n * matrices, which are reusable.\n */\nvar MatrixMath = {\n  createIdentityMatrix: function() {\n    return [\n      1,0,0,0,\n      0,1,0,0,\n      0,0,1,0,\n      0,0,0,1\n    ];\n  },\n\n  createCopy: function(m) {\n    return [\n      m[0],  m[1],  m[2],  m[3],\n      m[4],  m[5],  m[6],  m[7],\n      m[8],  m[9],  m[10], m[11],\n      m[12], m[13], m[14], m[15],\n    ];\n  },\n\n  createOrthographic: function(left, right, bottom, top, near, far) {\n    var a = 2 / (right - left);\n    var b = 2 / (top - bottom);\n    var c = -2 / (far - near);\n\n    var tx = -(right + left) / (right - left);\n    var ty = -(top + bottom) / (top - bottom);\n    var tz = -(far + near) / (far - near);\n\n    return [\n        a,  0,  0,  0,\n        0,  b,  0,  0,\n        0,  0,  c,  0,\n        tx, ty, tz, 1\n    ];\n  },\n\n  createFrustum: function(left, right, bottom, top, near, far) {\n    var r_width  = 1 / (right - left);\n    var r_height = 1 / (top - bottom);\n    var r_depth  = 1 / (near - far);\n    var x = 2 * (near * r_width);\n    var y = 2 * (near * r_height);\n    var A = (right + left) * r_width;\n    var B = (top + bottom) * r_height;\n    var C = (far + near) * r_depth;\n    var D = 2 * (far * near * r_depth);\n    return [\n      x, 0, 0, 0,\n      0, y, 0, 0,\n      A, B, C,-1,\n      0, 0, D, 0,\n    ];\n  },\n\n  /**\n   * This create a perspective projection towards negative z\n   * Clipping the z range of [-near, -far]\n   *\n   * @param fovInRadians - field of view in randians\n   */\n  createPerspective: function(fovInRadians, aspect, near, far) {\n    var h = 1 / Math.tan(fovInRadians / 2);\n    var r_depth  = 1 / (near - far);\n    var C = (far + near) * r_depth;\n    var D = 2 * (far * near * r_depth);\n    return [\n      h/aspect, 0, 0, 0,\n      0, h, 0, 0,\n      0, 0, C,-1,\n      0, 0, D, 0,\n    ];\n  },\n\n  createTranslate2d: function(x, y) {\n    var mat = MatrixMath.createIdentityMatrix();\n    MatrixMath.reuseTranslate2dCommand(mat, x, y);\n    return mat;\n  },\n\n  reuseTranslate2dCommand: function(matrixCommand, x, y) {\n    matrixCommand[12] = x;\n    matrixCommand[13] = y;\n  },\n\n  reuseTranslate3dCommand: function(matrixCommand, x, y, z) {\n    matrixCommand[12] = x;\n    matrixCommand[13] = y;\n    matrixCommand[14] = z;\n  },\n\n  createScale: function(factor) {\n    var mat = MatrixMath.createIdentityMatrix();\n    MatrixMath.reuseScaleCommand(mat, factor);\n    return mat;\n  },\n\n  reuseScaleCommand: function(matrixCommand, factor) {\n    matrixCommand[0] = factor;\n    matrixCommand[5] = factor;\n  },\n\n  reuseScale3dCommand: function(matrixCommand, x, y, z) {\n    matrixCommand[0] = x;\n    matrixCommand[5] = y;\n    matrixCommand[10] = z;\n  },\n\n  reusePerspectiveCommand: function(matrixCommand, p) {\n    matrixCommand[11] = -1 / p;\n  },\n\n  reuseScaleXCommand(matrixCommand, factor) {\n    matrixCommand[0] = factor;\n  },\n\n  reuseScaleYCommand(matrixCommand, factor) {\n    matrixCommand[5] = factor;\n  },\n\n  reuseScaleZCommand(matrixCommand, factor) {\n    matrixCommand[10] = factor;\n  },\n\n  reuseRotateXCommand: function(matrixCommand, radians) {\n    matrixCommand[5] = Math.cos(radians);\n    matrixCommand[6] = Math.sin(radians);\n    matrixCommand[9] = -Math.sin(radians);\n    matrixCommand[10] = Math.cos(radians);\n  },\n\n  reuseRotateYCommand: function(matrixCommand, amount) {\n    matrixCommand[0] = Math.cos(amount);\n    matrixCommand[2] = -Math.sin(amount);\n    matrixCommand[8] = Math.sin(amount);\n    matrixCommand[10] = Math.cos(amount);\n  },\n\n  // http://www.w3.org/TR/css3-transforms/#recomposing-to-a-2d-matrix\n  reuseRotateZCommand: function(matrixCommand, radians) {\n    matrixCommand[0] = Math.cos(radians);\n    matrixCommand[1] = Math.sin(radians);\n    matrixCommand[4] = -Math.sin(radians);\n    matrixCommand[5] = Math.cos(radians);\n  },\n\n  createRotateZ: function(radians) {\n    var mat = MatrixMath.createIdentityMatrix();\n    MatrixMath.reuseRotateZCommand(mat, radians);\n    return mat;\n  },\n\n  reuseSkewXCommand: function(matrixCommand, radians) {\n    matrixCommand[4] = Math.tan(radians);\n  },\n\n  reuseSkewYCommand: function(matrixCommand, radians) {\n    matrixCommand[1] = Math.tan(radians);\n  },\n\n  multiplyInto: function(out, a, b) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n      a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n      a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n      a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n\n    var b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n    out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n    out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n    out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n    out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n  },\n\n  determinant(matrix: Array<number>): number {\n    var [\n      m00, m01, m02, m03,\n      m10, m11, m12, m13,\n      m20, m21, m22, m23,\n      m30, m31, m32, m33\n    ] = matrix;\n    return (\n      m03 * m12 * m21 * m30 - m02 * m13 * m21 * m30 -\n      m03 * m11 * m22 * m30 + m01 * m13 * m22 * m30 +\n      m02 * m11 * m23 * m30 - m01 * m12 * m23 * m30 -\n      m03 * m12 * m20 * m31 + m02 * m13 * m20 * m31 +\n      m03 * m10 * m22 * m31 - m00 * m13 * m22 * m31 -\n      m02 * m10 * m23 * m31 + m00 * m12 * m23 * m31 +\n      m03 * m11 * m20 * m32 - m01 * m13 * m20 * m32 -\n      m03 * m10 * m21 * m32 + m00 * m13 * m21 * m32 +\n      m01 * m10 * m23 * m32 - m00 * m11 * m23 * m32 -\n      m02 * m11 * m20 * m33 + m01 * m12 * m20 * m33 +\n      m02 * m10 * m21 * m33 - m00 * m12 * m21 * m33 -\n      m01 * m10 * m22 * m33 + m00 * m11 * m22 * m33\n    );\n  },\n\n  /**\n   * Inverse of a matrix. Multiplying by the inverse is used in matrix math\n   * instead of division.\n   *\n   * Formula from:\n   * http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n   */\n  inverse(matrix: Array<number>): Array<number> {\n    var det = MatrixMath.determinant(matrix);\n    if (!det) {\n      return matrix;\n    }\n    var [\n      m00, m01, m02, m03,\n      m10, m11, m12, m13,\n      m20, m21, m22, m23,\n      m30, m31, m32, m33\n    ] = matrix;\n    return [\n      (m12*m23*m31 - m13*m22*m31 + m13*m21*m32 - m11*m23*m32 - m12*m21*m33 + m11*m22*m33) / det,\n      (m03*m22*m31 - m02*m23*m31 - m03*m21*m32 + m01*m23*m32 + m02*m21*m33 - m01*m22*m33) / det,\n      (m02*m13*m31 - m03*m12*m31 + m03*m11*m32 - m01*m13*m32 - m02*m11*m33 + m01*m12*m33) / det,\n      (m03*m12*m21 - m02*m13*m21 - m03*m11*m22 + m01*m13*m22 + m02*m11*m23 - m01*m12*m23) / det,\n      (m13*m22*m30 - m12*m23*m30 - m13*m20*m32 + m10*m23*m32 + m12*m20*m33 - m10*m22*m33) / det,\n      (m02*m23*m30 - m03*m22*m30 + m03*m20*m32 - m00*m23*m32 - m02*m20*m33 + m00*m22*m33) / det,\n      (m03*m12*m30 - m02*m13*m30 - m03*m10*m32 + m00*m13*m32 + m02*m10*m33 - m00*m12*m33) / det,\n      (m02*m13*m20 - m03*m12*m20 + m03*m10*m22 - m00*m13*m22 - m02*m10*m23 + m00*m12*m23) / det,\n      (m11*m23*m30 - m13*m21*m30 + m13*m20*m31 - m10*m23*m31 - m11*m20*m33 + m10*m21*m33) / det,\n      (m03*m21*m30 - m01*m23*m30 - m03*m20*m31 + m00*m23*m31 + m01*m20*m33 - m00*m21*m33) / det,\n      (m01*m13*m30 - m03*m11*m30 + m03*m10*m31 - m00*m13*m31 - m01*m10*m33 + m00*m11*m33) / det,\n      (m03*m11*m20 - m01*m13*m20 - m03*m10*m21 + m00*m13*m21 + m01*m10*m23 - m00*m11*m23) / det,\n      (m12*m21*m30 - m11*m22*m30 - m12*m20*m31 + m10*m22*m31 + m11*m20*m32 - m10*m21*m32) / det,\n      (m01*m22*m30 - m02*m21*m30 + m02*m20*m31 - m00*m22*m31 - m01*m20*m32 + m00*m21*m32) / det,\n      (m02*m11*m30 - m01*m12*m30 - m02*m10*m31 + m00*m12*m31 + m01*m10*m32 - m00*m11*m32) / det,\n      (m01*m12*m20 - m02*m11*m20 + m02*m10*m21 - m00*m12*m21 - m01*m10*m22 + m00*m11*m22) / det\n    ];\n  },\n\n  /**\n   * Turns columns into rows and rows into columns.\n   */\n   transpose(m: Array<number>): Array<number> {\n    return [\n      m[0], m[4], m[8],  m[12],\n      m[1], m[5], m[9],  m[13],\n      m[2], m[6], m[10], m[14],\n      m[3], m[7], m[11], m[15]\n    ];\n  },\n\n  /**\n   * Based on: http://tog.acm.org/resources/GraphicsGems/gemsii/unmatrix.c\n   */\n  multiplyVectorByMatrix(\n    v: Array<number>,\n    m: Array<number>\n  ): Array<number> {\n    var [vx, vy, vz, vw] = v;\n    return [\n      vx * m[0] + vy * m[4] + vz * m[8]  + vw * m[12],\n      vx * m[1] + vy * m[5] + vz * m[9]  + vw * m[13],\n      vx * m[2] + vy * m[6] + vz * m[10] + vw * m[14],\n      vx * m[3] + vy * m[7] + vz * m[11] + vw * m[15]\n    ];\n  },\n\n  /**\n   * From: https://code.google.com/p/webgl-mjs/source/browse/mjs.js\n   */\n  v3Length(a: Array<number>): number {\n    return Math.sqrt(a[0]*a[0] + a[1]*a[1] + a[2]*a[2]);\n  },\n\n  /**\n   * Based on: https://code.google.com/p/webgl-mjs/source/browse/mjs.js\n   */\n   v3Normalize(\n     vector: Array<number>,\n     v3Length: number\n    ): Array<number> {\n    var im = 1 / (v3Length || MatrixMath.v3Length(vector));\n    return [\n      vector[0] * im,\n      vector[1] * im,\n      vector[2] * im\n    ];\n  },\n\n  /**\n   * The dot product of a and b, two 3-element vectors.\n   * From: https://code.google.com/p/webgl-mjs/source/browse/mjs.js\n   */\n  v3Dot(a, b) {\n    return a[0] * b[0] +\n           a[1] * b[1] +\n           a[2] * b[2];\n  },\n\n  /**\n   * From:\n   * http://www.opensource.apple.com/source/WebCore/WebCore-514/platform/graphics/transforms/TransformationMatrix.cpp\n   */\n  v3Combine(\n    a: Array<number>,\n    b: Array<number>,\n    aScale: number,\n    bScale: number\n  ): Array<number> {\n    return [\n      aScale * a[0] + bScale * b[0],\n      aScale * a[1] + bScale * b[1],\n      aScale * a[2] + bScale * b[2]\n    ];\n  },\n\n  /**\n   * From:\n   * http://www.opensource.apple.com/source/WebCore/WebCore-514/platform/graphics/transforms/TransformationMatrix.cpp\n   */\n  v3Cross(a: Array<number>, b: Array<number>): Array<number> {\n    return [\n      a[1] * b[2] - a[2] * b[1],\n      a[2] * b[0] - a[0] * b[2],\n      a[0] * b[1] - a[1] * b[0]\n    ];\n  },\n\n  /**\n   * Based on:\n   * http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToEuler/\n   * and:\n   * http://quat.zachbennett.com/\n   *\n   * Note that this rounds degrees to the thousandth of a degree, due to\n   * floating point errors in the creation of the quaternion.\n   *\n   * Also note that this expects the qw value to be last, not first.\n   *\n   * Also, when researching this, remember that:\n   * yaw   === heading            === z-axis\n   * pitch === elevation/attitude === y-axis\n   * roll  === bank               === x-axis\n   */\n  quaternionToDegreesXYZ(q: Array<number>, matrix, row): Array<number> {\n    var [qx, qy, qz, qw] = q;\n    var qw2 = qw * qw;\n    var qx2 = qx * qx;\n    var qy2 = qy * qy;\n    var qz2 = qz * qz;\n    var test = qx * qy + qz * qw;\n    var unit = qw2 + qx2 + qy2 + qz2;\n    var conv = 180 / Math.PI;\n\n    if (test > 0.49999 * unit) {\n      return [0, 2 * Math.atan2(qx, qw) * conv, 90];\n    }\n    if (test < -0.49999 * unit) {\n      return [0, -2 * Math.atan2(qx, qw) * conv, -90];\n    }\n\n    return [\n      MatrixMath.roundTo3Places(\n        Math.atan2(2*qx*qw-2*qy*qz,1-2*qx2-2*qz2) * conv\n      ),\n      MatrixMath.roundTo3Places(\n        Math.atan2(2*qy*qw-2*qx*qz,1-2*qy2-2*qz2) * conv\n      ),\n      MatrixMath.roundTo3Places(\n        Math.asin(2*qx*qy+2*qz*qw) * conv\n      )\n    ];\n  },\n\n  /**\n   * Based on:\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round\n   */\n  roundTo3Places(n: number): number {\n    var arr = n.toString().split('e');\n    return Math.round(arr[0] + 'e' + (arr[1] ? (+arr[1] - 3) : 3)) * 0.001;\n  },\n\n  /**\n   * Decompose a matrix into separate transform values, for use on platforms\n   * where applying a precomposed matrix is not possible, and transforms are\n   * applied in an inflexible ordering (e.g. Android).\n   *\n   * Implementation based on\n   * http://www.w3.org/TR/css3-transforms/#decomposing-a-2d-matrix\n   * http://www.w3.org/TR/css3-transforms/#decomposing-a-3d-matrix\n   * which was based on\n   * http://tog.acm.org/resources/GraphicsGems/gemsii/unmatrix.c\n   */\n  decomposeMatrix(transformMatrix: Array<number>): ?Object {\n\n    invariant(\n      transformMatrix.length === 16,\n      'Matrix decomposition needs a list of 3d matrix values, received %s',\n      transformMatrix\n    );\n\n    // output values\n    var perspective = [];\n    var quaternion = [];\n    var scale = [];\n    var skew = [];\n    var translation = [];\n\n    // create normalized, 2d array matrix\n    // and normalized 1d array perspectiveMatrix with redefined 4th column\n    if (!transformMatrix[15]) {\n      return;\n    }\n    var matrix = [];\n    var perspectiveMatrix = [];\n    for (var i = 0; i < 4; i++) {\n      matrix.push([]);\n      for (var j = 0; j < 4; j++) {\n        var value = transformMatrix[(i * 4) + j] / transformMatrix[15];\n        matrix[i].push(value);\n        perspectiveMatrix.push(j === 3 ? 0 : value);\n      }\n    }\n    perspectiveMatrix[15] = 1;\n\n    // test for singularity of upper 3x3 part of the perspective matrix\n    if (!MatrixMath.determinant(perspectiveMatrix)) {\n      return;\n    }\n\n    // isolate perspective\n    if (matrix[0][3] !== 0 || matrix[1][3] !== 0 || matrix[2][3] !== 0) {\n      // rightHandSide is the right hand side of the equation.\n      // rightHandSide is a vector, or point in 3d space relative to the origin.\n      var rightHandSide = [\n        matrix[0][3],\n        matrix[1][3],\n        matrix[2][3],\n        matrix[3][3]\n      ];\n\n      // Solve the equation by inverting perspectiveMatrix and multiplying\n      // rightHandSide by the inverse.\n      var inversePerspectiveMatrix = MatrixMath.inverse(\n        perspectiveMatrix\n      );\n      var transposedInversePerspectiveMatrix = MatrixMath.transpose(\n        inversePerspectiveMatrix\n      );\n      var perspective = MatrixMath.multiplyVectorByMatrix(\n        rightHandSide,\n        transposedInversePerspectiveMatrix\n      );\n    } else {\n      // no perspective\n      perspective[0] = perspective[1] = perspective[2] = 0;\n      perspective[3] = 1;\n    }\n\n    // translation is simple\n    for (var i = 0; i < 3; i++) {\n      translation[i] = matrix[3][i];\n    }\n\n    // Now get scale and shear.\n    // 'row' is a 3 element array of 3 component vectors\n    var row = [];\n    for (i = 0; i < 3; i++) {\n      row[i] = [\n        matrix[i][0],\n        matrix[i][1],\n        matrix[i][2]\n      ];\n    }\n\n    // Compute X scale factor and normalize first row.\n    scale[0] = MatrixMath.v3Length(row[0]);\n    row[0] = MatrixMath.v3Normalize(row[0], scale[0]);\n\n    // Compute XY shear factor and make 2nd row orthogonal to 1st.\n    skew[0] = MatrixMath.v3Dot(row[0], row[1]);\n    row[1] = MatrixMath.v3Combine(row[1], row[0], 1.0, -skew[0]);\n\n    // Compute XY shear factor and make 2nd row orthogonal to 1st.\n    skew[0] = MatrixMath.v3Dot(row[0], row[1]);\n    row[1] = MatrixMath.v3Combine(row[1], row[0], 1.0, -skew[0]);\n\n    // Now, compute Y scale and normalize 2nd row.\n    scale[1] = MatrixMath.v3Length(row[1]);\n    row[1] = MatrixMath.v3Normalize(row[1], scale[1]);\n    skew[0] /= scale[1];\n\n    // Compute XZ and YZ shears, orthogonalize 3rd row\n    skew[1] = MatrixMath.v3Dot(row[0], row[2]);\n    row[2] = MatrixMath.v3Combine(row[2], row[0], 1.0, -skew[1]);\n    skew[2] = MatrixMath.v3Dot(row[1], row[2]);\n    row[2] = MatrixMath.v3Combine(row[2], row[1], 1.0, -skew[2]);\n\n    // Next, get Z scale and normalize 3rd row.\n    scale[2] = MatrixMath.v3Length(row[2]);\n    row[2] = MatrixMath.v3Normalize(row[2], scale[2]);\n    skew[1] /= scale[2];\n    skew[2] /= scale[2];\n\n    // At this point, the matrix (in rows) is orthonormal.\n    // Check for a coordinate system flip.  If the determinant\n    // is -1, then negate the matrix and the scaling factors.\n    var pdum3 = MatrixMath.v3Cross(row[1], row[2]);\n    if (MatrixMath.v3Dot(row[0], pdum3) < 0) {\n      for (i = 0; i < 3; i++) {\n        scale[i] *= -1;\n        row[i][0] *= -1;\n        row[i][1] *= -1;\n        row[i][2] *= -1;\n      }\n    }\n\n    // Now, get the rotations out\n    quaternion[0] =\n      0.5 * Math.sqrt(Math.max(1 + row[0][0] - row[1][1] - row[2][2], 0));\n    quaternion[1] =\n      0.5 * Math.sqrt(Math.max(1 - row[0][0] + row[1][1] - row[2][2], 0));\n    quaternion[2] =\n      0.5 * Math.sqrt(Math.max(1 - row[0][0] - row[1][1] + row[2][2], 0));\n    quaternion[3] =\n      0.5 * Math.sqrt(Math.max(1 + row[0][0] + row[1][1] + row[2][2], 0));\n\n    if (row[2][1] > row[1][2]) {\n      quaternion[0] = -quaternion[0];\n    }\n    if (row[0][2] > row[2][0]) {\n      quaternion[1] = -quaternion[1];\n    }\n    if (row[1][0] > row[0][1]) {\n      quaternion[2] = -quaternion[2];\n    }\n\n    // correct for occasional, weird Euler synonyms for 2d rotation\n    var rotationDegrees;\n    if (\n      quaternion[0] < 0.001 && quaternion[0] >= 0 &&\n      quaternion[1] < 0.001 && quaternion[1] >= 0\n    ) {\n      // this is a 2d rotation on the z-axis\n      rotationDegrees = [0, 0, MatrixMath.roundTo3Places(\n        Math.atan2(row[0][1], row[0][0]) * 180 / Math.PI\n      )];\n    } else {\n      rotationDegrees = MatrixMath.quaternionToDegreesXYZ(quaternion, matrix, row);\n    }\n\n    // expose both base data and convenience names\n    return {\n      rotationDegrees,\n      perspective,\n      quaternion,\n      scale,\n      skew,\n      translation,\n\n      rotate: rotationDegrees[2],\n      rotateX: rotationDegrees[0],\n      rotateY: rotationDegrees[1],\n      scaleX: scale[0],\n      scaleY: scale[1],\n      translateX: translation[0],\n      translateY: translation[1],\n    };\n  },\n\n};\n\nmodule.exports = MatrixMath;\n"]}